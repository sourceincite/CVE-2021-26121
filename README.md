# CS-Cart Server Side Template Injection Remote Code Execution Vulnerability

Found by: Steven Seeley of 360 Vulcan Team  
Version: <= 4.12.x (latest)  
Date: 2020-01-08 12:49  
CVE: CVE-2021-26121  

# Disclosure Timeline

- 2020-01-26 – Sent to cs-cart dev team
- 2020-01-27 – Notification of reciept from cs-cart dev team
- 2020-02-10 – Response from cs-cart as not a security bug, restrict access from shop administrators
- 2020-02-12 – Public disclosure

# Summary

A shop admin (not to be confused with a root admin) can gain remote code execution via server-side template injection when editing templates. 

# Notes

This is not normally a huge concern but on cs-cart it means that a shop admin can get access to other shop admins data (and the underlying OS). I imagine you do consider this security boundary, which is why you patched CVE-2017-15673.

# Proof of Concept

When logging in as a Shop admin they can edit any of the templates, in this case I edited the `my_account.tpl` file adding `{phpinfo()}`

![](images/fdaf961b7930495590a332aa1259ce78.png)

Then, after viewing the index page, it's possible to trigger the template execution:

![](images/6f34195ad5d94050a6f2c40289dd91ef.png)

It is also possible to trigger this vulnerability if the Shop admin has just `Files` access via group assignment and no other permission.

![](images/03f11c18ad744284895519686ae7b07b.png)

And here is the vulnerability impacting the `https://[redacted]/` demo site:

![](images/94e40c2037a54db3a831c195ccdd3a7a.png)
